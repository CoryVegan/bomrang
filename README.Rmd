---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

# _bomrang_: Fetch Australian Government Bureau of Meteorology (BOM) Data

[![Travis-CI Build Status](https://travis-ci.org/ToowoombaTrio/bomrang.svg?branch=master)](https://travis-ci.org/ToowoombaTrio/bomrang)
[![AppVeyor Build Status](https://ci.appveyor.com/api/projects/status/github/ToowoombaTrio/bomrang?branch=master&svg=true)](https://ci.appveyor.com/project/ToowoombaTrio/bomrang)
[![Coverage Status](https://img.shields.io/codecov/c/github/ToowoombaTrio/bomrang/master.svg)](https://codecov.io/github/ToowoombaTrio/bomrang?branch=master)
[![Last-changedate](https://img.shields.io/badge/last%20change-`r gsub('-', '--', Sys.Date())`-brightgreen.svg)](https://github.com/toowoombatrio/bomrang/commits/master) 
[![minimal R version](https://img.shields.io/badge/R%3E%3D-`r as.character(getRversion())`-brightgreen.svg)](https://cran.r-project.org/)
[![Licence](https://img.shields.io/github/license/mashape/apistatus.svg)](http://choosealicense.com/licenses/mit/) 
[![DOI](https://zenodo.org/badge/89690315.svg)](https://zenodo.org/badge/latestdoi/89690315)

Fetches Australian Government Bureau of Meteorology data and returns a tidy data frame.

Credit for the name, _bomrang_, goes to [Di Cook](http://dicook.github.io), who
suggested it attending the rOpenSci AUUnconf in Brisbane, 2016, when seeing the
[vignette](https://github.com/saundersk1/auunconf16/blob/master/Vignette_BoM.pdf)
that we had assembled during the Unconf.

## Quick start

```{r, eval=FALSE}
if (!require("devtools")) {
  install.packages("devtools", repos = "http://cran.rstudio.com/") 
  library("devtools")
}

devtools::install_github("toowoombatrio/bomrang")
```

## Using _bomrang_

Three main functions are provided. `get_precis_forecast()`, which retreives the précis forecast; `get_current_weather()`, which fetches the current weather at a given station; and `get_ag_bulletin()`, which retrives the agriculture bulletin. `get_precis_forecast()` and `get_ag_bulletin()` will allow you to fetch data for an individual state or all at once, i.e., all of Australia. To fetch an individual state, simply use the official postal code for the state for the `state` parameter. To fetch data for all of Australia, use "AUS" in the `state` parameter.

### Using `get_precis_forecast()`

This function only takes one parameter, `state`. States are specified using the official postal codes, 

* **ACT** - Australian Capital Territory  
* **NSW** - New South Wales  
* **NT** - Northern Territory  
* **QLD** - Queensland  
* **SA** - South Australia  
* **TAS** - Tasmania  
* **VIC** - Victoria  
* **WA** - Western Australia  
* **AUS** - Australia, returns national forecast including all states  

#### Results

The function, `get_precis_forecast()` will return a tidy data frame of the weather forecast for the daily forecast with the following fields,

* **aac** - AMOC Area Code, _e.g._, WA_MW008, a unique identifier for each location  
* **start_time_local** - Start of forecast date and time in local TZ  
* **end_time_local** - End of forecast date and time in local TZ  
* **UTC_offset** -  Hours offset from difference in hours and minutes from Coordinated Universal Time (UTC) for `start_time_local` and `end_time_local`
* **start_time_utc** - Start of forecast date and time in UTC  
* **end_time_utc** - End of forecast date and time in UTC  
* **max_temp** - Maximum forecasted temperature (degrees Celsius)  
* **min_temp** - Minimum forecasted temperature (degrees Celsius)  
* **lower_prcp_limit** - Lower forecasted precipitation limit (millimetres)  
* **upper_prcp_limit** - Upper forecasted precipitation limit (millimetres)  
* **precis** - Précis forecast (a short summary, less than 30 characters)  
* **prob_prcp** - Probability of precipitation (percent)  
* **location** - Named location for forecast  
* **state** - State name (postal code abbreviation)  
* **lon** - Longitude of named location (decimal degrees)  
* **lat** - Latitude of named location (decimal degrees)  
* **elev** - Elevation of named location (metres)  

### Examples

Following is an example fetching the forecast for Queensland.

```{r, eval=TRUE}
library("bomrang")

QLD_forecast <- get_precis_forecast(state = "QLD")
head(QLD_forecast)
```

### Using `get_ag_bulletin()`

This function only takes one parameter, `state`. The `state` parameter allows the user to select the bulletin for just one state or a national bulletin. States are specified using the official postal codes, 

* **ACT** - Australian Capital Territory  
* **NSW** - New South Wales  
* **NT** - Northern Territory  
* **QLD** - Queensland  
* **SA** - South Australia  
* **TAS** - Tasmania  
* **VIC** - Victoria  
* **WA** - Western Australia  
* **AUS** - Australia, returns bulletin for all states  

#### Results

The function, `get_ag_bulletin()` will return a tidy data frame of the agriculture bulletin with the following fields,

* **obs_time_utc** - Observation time (Time in UTC)  
* **time_zone** - Time zone for observation  
* **site** - Unique BOM identifier for each station  
* **name** - BOM station name  
* **r** - Rain to 9am (millimetres). _Trace will be reported as 0.01_  
* **tn** - Minimum temperature (degrees Celsius)  
* **tx** - Maximum temperature (degrees Celsius)  
* **twd** - Wetbulb depression (degress Celsius)  
* **ev** - Evaporation (millimetres)  
* **tg** - Terrestrial minimum temperature (degress Celsius)  
* **sn** - Sunshine (Hours)  
* **t5** - 5cm soil temperature (degrees Celsius)  
* **t10** - 10cm soil temperature (degrees Celsius)  
* **t20** - 20cm soil temperature (degrees Celsius)  
* **t50** - 50cm soil temperature (degrees Celsius)  
* **t1m** - 1m soil temperature (degrees Celsius)  
* **wr** - Wind run (kilometres)  
* **state** - State name (postal code abbreviation)  
* **lat** - Latitude (decimal degrees)  
* **lon** - Longitude (decimal degrees)  

```{r, eval=TRUE}
library("bomrang")

QLD_bulletin <- get_ag_bulletin(state = "QLD")
head(QLD_bulletin)
```

### Using `get_current_weather()`
Returns the latest 72 hours weather observations for a station.

This function accepts four parameters:

* `station_name`, The name of the weather station. Fuzzy string matching via `base::agrep` is done.

* `latlon`, A length-2 numeric vector. When given instead of station_name, the nearest station (in this package) is used, with a message indicating the nearest such station. (See also `sweep_for_stations()`.) Ignored if used in combination with `station_name`, with a warning.

* `raw` Do not convert the columns data.table to the appropriate classes. (FALSE by default.)

* `emit_latlon_msg` Logical. If `TRUE` (the default), and `latlon`} is selected, a message is emitted before the table is returned indicating which station was actually used (i.e. which station was found to be nearest to the given coordinate).

```{r, eval=TRUE}
library("bomrang")

Melbourne_weather <- get_current_weather("Melbourne (Olympic Park)")
head(Melbourne_weather)
```

#### Results

The function, `get_current()` will return a tidy data frame of the current and past 72 hours observations for the requested station. The fields returned will vary between stations dependent upon the data that they provide. See the [BOM website](http://www.bom.gov.au/catalogue/observations/about-weather-observations.shtml) for more information.

## Meta

* Please [report any issues or bugs](https://github.com/ToowoombaTrio/bomrang/issues).  
* License: MIT  
* To cite _bomrang_, please use:  
  Sparks A, Parsonage H, and Pembleton K (2017). _bomrang: Fetch Australian Government Bureau of Meteorology Weather Data_. R package version 0.0.1-1,
<URL: https://github.com/ToowoombaTrio/bomrang>.  
* Please note that this project is released with a [Contributor Code of Conduct](CONDUCT.md). By participating in this project you agree to abide by its terms.  
* BOM Copyright Notice http://reg.bom.gov.au/other/copyright.shtml  

## References

[Australian Bureau of Meteorology (BOM) Weather Data Services](http://www.bom.gov.au/catalogue/data-feeds.shtml)

[Australian Bureau of Meteorology (BOM) Weather Data Services Agriculture Bulletins](http://www.bom.gov.au/catalogue/observations/about-agricultural.shtml)

[Australian Bureau of Meteorology (BOM) Weather Data Services Observation of Rainfall](http://www.bom.gov.au/climate/how/observations/rain-measure.shtml)

